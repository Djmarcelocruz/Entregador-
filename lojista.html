<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solicitar Entrega - Quintana</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBjP9dxFEp09DpZl5JkVMD05uaKoQTNDpE",
            authDomain: "meuappentregas.firebaseapp.com",
            projectId: "meuappentregas",
            storageBucket: "meuappentregas.firebasestorage.app",
            messagingSenderId: "442484186787",
            appId: "1:442484186787:web:ac914827ebebda987f2916"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // FunÃ§Ã£o para sugerir valor baseado na cidade
        window.calcularValor = () => {
            const end = document.getElementById('destino').value.toLowerCase();
            let valor = 7.00; // Valor padrÃ£o Quintana
            if (end.includes('pompeia') || end.includes('herculandia') || end.includes('paulopolis')) {
                valor = 20.00; // Valor viagem
            }
            document.getElementById('valorSugestao').innerText = `Valor estimado: R$ ${valor.toFixed(2)}`;
            return valor;
        };

        window.enviarPedido = async () => {
            const loja = document.getElementById('nomeLoja').value;
            const zap = document.getElementById('zapLoja').value;
            const retirada = document.getElementById('retirada').value;
            const destino = document.getElementById('destino').value;
            const valor = window.calcularValor();

            if(!loja || !retirada || !destino) return alert("Preencha os campos!");

            await addDoc(collection(db, "pedidos"), {
                loja, zap, retirada, destino, valor,
                status: "Aguardando",
                timestamp: Date.now()
            });
            alert("Pedido enviado! O entregador jÃ¡ foi notificado.");
            document.getElementById('destino').value = "";
        };
    </script>
</head>
<body class="bg-blue-50 p-4">
    <div class="max-w-md mx-auto bg-white p-6 rounded-3xl shadow-xl border-b-4 border-blue-600">
        <h2 class="text-2xl font-black text-blue-900 mb-6 text-center italic">ENTREGAS QUINTANA ðŸ›µ</h2>
        
        <div class="space-y-4">
            <input id="nomeLoja" type="text" placeholder="Seu Nome ou Nome da Loja" class="w-full p-4 bg-gray-100 rounded-2xl border-none outline-blue-500 font-bold">
            <input id="zapLoja" type="tel" placeholder="Seu WhatsApp (com DDD)" class="w-full p-4 bg-gray-100 rounded-2xl border-none outline-blue-500">
            <input id="retirada" type="text" placeholder="Onde retirar? (Ex: Rua Direita, 10)" class="w-full p-4 bg-gray-100 rounded-2xl border-none outline-blue-500">
            <input id="destino" type="text" oninput="calcularValor()" placeholder="Destino da Entrega (EndereÃ§o Completo)" class="w-full p-4 bg-gray-100 rounded-2xl border-none outline-blue-500 font-bold">
            
            <div id="valorSugestao" class="text-center font-black text-green-600 text-lg py-2 italic">Valor estimado: R$ 7,00</div>
            
            <button onclick="enviarPedido()" class="w-full bg-blue-600 text-white font-black py-5 rounded-2xl shadow-lg active:scale-95 transition-all text-xl">PEDIR AGORA</button>
        </div>
    </div>
</body>
</html>
